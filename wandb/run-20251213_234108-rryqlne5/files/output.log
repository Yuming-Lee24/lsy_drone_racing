Training on device: cuda | Environment device: gpu
Config: level0.toml
[make_env] 配置: level0.toml, 门数: 4, 障碍物数: 4
/data/repos/lsy_drone_racing/.pixi/envs/default/lib/python3.13/site-packages/jax/_src/abstract_arrays.py:135: RuntimeWarning: overflow encountered in cast
  return literals.TypedNdArray(np.asarray(x, dtype), weak_type=False)
Observation dim: 88, Action dim: 4
训练开始。按 Ctrl+C 可安全停止并保存到: /data/repos/lsy_drone_racing/lsy_drone_racing/rl_training/checkpoints/ppo_racing.ckpt
Iter 1/2441 | Steps: 0.01M/20.00M
  [Perf] Avg Rew: -196.31
  [Loss] Val: 378.9882 | Pol: -0.0181 | Ent: 2.1723 | KL: 0.0075
  [Time] 4.21s | SPS: 1944
--------------------------------------------------
Iter 10/2441 | Steps: 0.08M/20.00M
  [Perf] Avg Rew: -99.60
  [Loss] Val: 67.0470 | Pol: -0.0168 | Ent: 1.9848 | KL: 0.0077
  [Time] 2.88s | SPS: 2843
--------------------------------------------------
Iter 20/2441 | Steps: 0.16M/20.00M
  [Perf] Avg Rew: -71.55
  [Loss] Val: 27.8674 | Pol: -0.0117 | Ent: 1.7332 | KL: 0.0067
  [Time] 2.96s | SPS: 2771
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -71.55)
Iter 30/2441 | Steps: 0.25M/20.00M
  [Perf] Avg Rew: -60.61
  [Loss] Val: 19.6765 | Pol: -0.0104 | Ent: 1.6183 | KL: 0.0067
  [Time] 3.87s | SPS: 2116
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -60.61)
Iter 40/2441 | Steps: 0.33M/20.00M
  [Perf] Avg Rew: -52.80
  [Loss] Val: 18.3902 | Pol: -0.0045 | Ent: 1.5616 | KL: 0.0107
  [Time] 2.96s | SPS: 2770
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -52.80)
Iter 50/2441 | Steps: 0.41M/20.00M
  [Perf] Avg Rew: -48.10
  [Loss] Val: 24.9288 | Pol: -0.0070 | Ent: 1.4907 | KL: 0.0048
  [Time] 3.01s | SPS: 2718
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -48.10)
Iter 60/2441 | Steps: 0.49M/20.00M
  [Perf] Avg Rew: -52.10
  [Loss] Val: 22.8282 | Pol: -0.0078 | Ent: 1.4002 | KL: 0.0086
  [Time] 2.92s | SPS: 2806
--------------------------------------------------
Iter 70/2441 | Steps: 0.57M/20.00M
  [Perf] Avg Rew: -32.09
  [Loss] Val: 10.1482 | Pol: -0.0117 | Ent: 1.3319 | KL: 0.0115
  [Time] 3.08s | SPS: 2658
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -32.09)
Iter 80/2441 | Steps: 0.66M/20.00M
  [Perf] Avg Rew: -27.18
  [Loss] Val: 13.1115 | Pol: -0.0131 | Ent: 1.2441 | KL: 0.0068
  [Time] 3.45s | SPS: 2375
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -27.18)
Iter 90/2441 | Steps: 0.74M/20.00M
  [Perf] Avg Rew: -29.08
  [Loss] Val: 9.5768 | Pol: 0.0007 | Ent: 1.1406 | KL: 0.0137
  [Time] 3.35s | SPS: 2447
--------------------------------------------------
Iter 100/2441 | Steps: 0.82M/20.00M
  [Perf] Avg Rew: -17.84
  [Loss] Val: 9.0764 | Pol: -0.0105 | Ent: 1.0308 | KL: 0.0095
  [Time] 3.37s | SPS: 2432
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -17.84)
Iter 110/2441 | Steps: 0.90M/20.00M
  [Perf] Avg Rew: -6.17
  [Loss] Val: 12.9052 | Pol: -0.0076 | Ent: 0.9272 | KL: 0.0111
  [Time] 3.83s | SPS: 2138
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: -6.17)
Iter 120/2441 | Steps: 0.98M/20.00M
  [Perf] Avg Rew: -7.91
  [Loss] Val: 9.5556 | Pol: -0.0121 | Ent: 0.7971 | KL: 0.0055
  [Time] 2.48s | SPS: 3298
--------------------------------------------------
Iter 130/2441 | Steps: 1.06M/20.00M
  [Perf] Avg Rew: 9.37
  [Loss] Val: 21.1136 | Pol: 0.0031 | Ent: 0.6730 | KL: 0.0140
  [Time] 4.52s | SPS: 1813
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 9.37)
Iter 140/2441 | Steps: 1.15M/20.00M
  [Perf] Avg Rew: 21.31
  [Loss] Val: 20.1237 | Pol: 0.0184 | Ent: 0.5756 | KL: 0.0380
  [Time] 2.63s | SPS: 3111
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 21.31)
Iter 150/2441 | Steps: 1.23M/20.00M
  [Perf] Avg Rew: 53.81
  [Loss] Val: 31.2151 | Pol: -0.0135 | Ent: 0.5389 | KL: 0.0074
  [Time] 4.33s | SPS: 1892
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 53.81)
Iter 160/2441 | Steps: 1.31M/20.00M
  [Perf] Avg Rew: 76.18
  [Loss] Val: 38.4342 | Pol: -0.0146 | Ent: 0.4647 | KL: 0.0063
  [Time] 2.65s | SPS: 3091
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 76.18)
Iter 170/2441 | Steps: 1.39M/20.00M
  [Perf] Avg Rew: 96.50
  [Loss] Val: 65.7655 | Pol: -0.0123 | Ent: 0.3960 | KL: 0.0068
  [Time] 2.72s | SPS: 3014
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 96.50)
Iter 180/2441 | Steps: 1.47M/20.00M
  [Perf] Avg Rew: 78.98
  [Loss] Val: 63.2140 | Pol: -0.0033 | Ent: 0.3404 | KL: 0.0104
  [Time] 3.28s | SPS: 2493
--------------------------------------------------
Iter 190/2441 | Steps: 1.56M/20.00M
  [Perf] Avg Rew: 95.62
  [Loss] Val: 56.6286 | Pol: 0.0217 | Ent: 0.2943 | KL: 0.0440
  [Time] 4.35s | SPS: 1883
--------------------------------------------------
Iter 200/2441 | Steps: 1.64M/20.00M
  [Perf] Avg Rew: 192.88
  [Loss] Val: 57.1980 | Pol: -0.0089 | Ent: 0.2448 | KL: 0.0076
  [Time] 2.36s | SPS: 3473
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 192.88)
Iter 210/2441 | Steps: 1.72M/20.00M
  [Perf] Avg Rew: 163.30
  [Loss] Val: 45.8621 | Pol: -0.0105 | Ent: 0.2245 | KL: 0.0122
  [Time] 4.16s | SPS: 1971
--------------------------------------------------
Iter 220/2441 | Steps: 1.80M/20.00M
  [Perf] Avg Rew: 247.80
  [Loss] Val: 61.5449 | Pol: -0.0107 | Ent: 0.1905 | KL: 0.0066
  [Time] 2.44s | SPS: 3362
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 247.80)
Iter 230/2441 | Steps: 1.88M/20.00M
  [Perf] Avg Rew: 207.35
  [Loss] Val: 66.8274 | Pol: 0.0075 | Ent: 0.2016 | KL: 0.0301
  [Time] 24.57s | SPS: 333
--------------------------------------------------
Iter 240/2441 | Steps: 1.97M/20.00M
  [Perf] Avg Rew: 191.15
  [Loss] Val: 68.1328 | Pol: -0.0050 | Ent: 0.2291 | KL: 0.0095
  [Time] 3.99s | SPS: 2055
--------------------------------------------------
Iter 250/2441 | Steps: 2.05M/20.00M
  [Perf] Avg Rew: 218.18
  [Loss] Val: 68.2070 | Pol: -0.0128 | Ent: 0.2748 | KL: 0.0097
  [Time] 3.93s | SPS: 2083
--------------------------------------------------
Iter 260/2441 | Steps: 2.13M/20.00M
  [Perf] Avg Rew: 116.22
  [Loss] Val: 56.3641 | Pol: -0.0136 | Ent: 0.3777 | KL: 0.0116
  [Time] 2.74s | SPS: 2992
--------------------------------------------------
Iter 270/2441 | Steps: 2.21M/20.00M
  [Perf] Avg Rew: 104.53
  [Loss] Val: 54.6271 | Pol: -0.0019 | Ent: 0.4305 | KL: 0.0206
  [Time] 3.88s | SPS: 2113
--------------------------------------------------
Iter 280/2441 | Steps: 2.29M/20.00M
  [Perf] Avg Rew: 127.67
  [Loss] Val: 24.2752 | Pol: -0.0130 | Ent: 0.4328 | KL: 0.0104
  [Time] 2.19s | SPS: 3747
--------------------------------------------------
Iter 290/2441 | Steps: 2.38M/20.00M
  [Perf] Avg Rew: 270.20
  [Loss] Val: 9.7061 | Pol: -0.0144 | Ent: 0.4249 | KL: 0.0076
  [Time] 3.61s | SPS: 2272
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 270.20)
Iter 300/2441 | Steps: 2.46M/20.00M
  [Perf] Avg Rew: 391.40
  [Loss] Val: 37.3634 | Pol: -0.0109 | Ent: 0.4404 | KL: 0.0160
  [Time] 3.86s | SPS: 2119
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 391.40)
Iter 310/2441 | Steps: 2.54M/20.00M
  [Perf] Avg Rew: 415.08
  [Loss] Val: 32.3540 | Pol: -0.0124 | Ent: 0.4432 | KL: 0.0066
  [Time] 3.87s | SPS: 2116
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 415.08)
Iter 320/2441 | Steps: 2.62M/20.00M
  [Perf] Avg Rew: 465.15
  [Loss] Val: 11.5226 | Pol: -0.0011 | Ent: 0.4294 | KL: 0.0185
  [Time] 3.69s | SPS: 2218
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 465.15)
Iter 330/2441 | Steps: 2.70M/20.00M
  [Perf] Avg Rew: 513.26
  [Loss] Val: 25.8648 | Pol: -0.0006 | Ent: 0.4266 | KL: 0.0260
  [Time] 2.05s | SPS: 3991
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 513.26)
Iter 340/2441 | Steps: 2.79M/20.00M
  [Perf] Avg Rew: 456.85
  [Loss] Val: 30.1923 | Pol: 0.0001 | Ent: 0.4386 | KL: 0.0326
  [Time] 3.71s | SPS: 2206
--------------------------------------------------
Iter 350/2441 | Steps: 2.87M/20.00M
  [Perf] Avg Rew: 485.64
  [Loss] Val: 20.8512 | Pol: -0.0115 | Ent: 0.4782 | KL: 0.0118
  [Time] 3.73s | SPS: 2196
--------------------------------------------------
Iter 360/2441 | Steps: 2.95M/20.00M
  [Perf] Avg Rew: 419.46
  [Loss] Val: 23.2561 | Pol: -0.0014 | Ent: 0.4517 | KL: 0.0180
  [Time] 1.99s | SPS: 4126
--------------------------------------------------
Iter 370/2441 | Steps: 3.03M/20.00M
  [Perf] Avg Rew: 508.97
  [Loss] Val: 20.9144 | Pol: -0.0119 | Ent: 0.4776 | KL: 0.0185
  [Time] 3.67s | SPS: 2232
--------------------------------------------------
Iter 380/2441 | Steps: 3.11M/20.00M
  [Perf] Avg Rew: 471.64
  [Loss] Val: 8.7967 | Pol: -0.0091 | Ent: 0.4682 | KL: 0.0164
  [Time] 1.89s | SPS: 4331
--------------------------------------------------
Iter 390/2441 | Steps: 3.19M/20.00M
  [Perf] Avg Rew: 431.37
  [Loss] Val: 44.1318 | Pol: -0.0128 | Ent: 0.5311 | KL: 0.0066
  [Time] 3.85s | SPS: 2130
--------------------------------------------------
Iter 400/2441 | Steps: 3.28M/20.00M
  [Perf] Avg Rew: 349.57
  [Loss] Val: 16.5450 | Pol: -0.0088 | Ent: 0.5725 | KL: 0.0163
  [Time] 2.22s | SPS: 3698
--------------------------------------------------
Iter 410/2441 | Steps: 3.36M/20.00M
  [Perf] Avg Rew: 368.49
  [Loss] Val: 18.8135 | Pol: -0.0104 | Ent: 0.5742 | KL: 0.0116
  [Time] 2.19s | SPS: 3747
--------------------------------------------------
Iter 420/2441 | Steps: 3.44M/20.00M
  [Perf] Avg Rew: 410.32
  [Loss] Val: 34.3524 | Pol: -0.0139 | Ent: 0.5636 | KL: 0.0099
  [Time] 2.30s | SPS: 3560
--------------------------------------------------
Iter 430/2441 | Steps: 3.52M/20.00M
  [Perf] Avg Rew: 403.38
  [Loss] Val: 21.4024 | Pol: -0.0130 | Ent: 0.6609 | KL: 0.0145
  [Time] 2.23s | SPS: 3669
--------------------------------------------------
Iter 440/2441 | Steps: 3.60M/20.00M
  [Perf] Avg Rew: 382.72
  [Loss] Val: 36.7695 | Pol: -0.0130 | Ent: 0.6589 | KL: 0.0112
  [Time] 3.72s | SPS: 2203
--------------------------------------------------
Iter 450/2441 | Steps: 3.69M/20.00M
  [Perf] Avg Rew: 414.77
  [Loss] Val: 19.7015 | Pol: -0.0045 | Ent: 0.6572 | KL: 0.0221
  [Time] 3.81s | SPS: 2151
--------------------------------------------------
Iter 460/2441 | Steps: 3.77M/20.00M
  [Perf] Avg Rew: 436.31
  [Loss] Val: 13.8293 | Pol: -0.0122 | Ent: 0.6678 | KL: 0.0080
  [Time] 3.68s | SPS: 2223
--------------------------------------------------
Iter 470/2441 | Steps: 3.85M/20.00M
  [Perf] Avg Rew: 473.71
  [Loss] Val: 24.7965 | Pol: -0.0104 | Ent: 0.7152 | KL: 0.0118
  [Time] 3.72s | SPS: 2203
--------------------------------------------------
Iter 480/2441 | Steps: 3.93M/20.00M
  [Perf] Avg Rew: 393.54
  [Loss] Val: 28.7408 | Pol: -0.0165 | Ent: 0.7583 | KL: 0.0141
  [Time] 3.94s | SPS: 2077
--------------------------------------------------
Iter 490/2441 | Steps: 4.01M/20.00M
  [Perf] Avg Rew: 433.75
  [Loss] Val: 19.6489 | Pol: -0.0064 | Ent: 0.7821 | KL: 0.0237
  [Time] 2.17s | SPS: 3773
--------------------------------------------------
Iter 500/2441 | Steps: 4.10M/20.00M
  [Perf] Avg Rew: 388.41
  [Loss] Val: 15.9898 | Pol: -0.0081 | Ent: 0.7678 | KL: 0.0183
  [Time] 3.66s | SPS: 2238
--------------------------------------------------
Iter 510/2441 | Steps: 4.18M/20.00M
  [Perf] Avg Rew: 459.29
  [Loss] Val: 25.6293 | Pol: -0.0183 | Ent: 0.7911 | KL: 0.0094
  [Time] 2.03s | SPS: 4035
--------------------------------------------------
Iter 520/2441 | Steps: 4.26M/20.00M
  [Perf] Avg Rew: 281.51
  [Loss] Val: 33.8972 | Pol: -0.0165 | Ent: 0.7946 | KL: 0.0112
  [Time] 2.24s | SPS: 3657
--------------------------------------------------
Iter 530/2441 | Steps: 4.34M/20.00M
  [Perf] Avg Rew: 408.05
  [Loss] Val: 26.9630 | Pol: -0.0059 | Ent: 0.8253 | KL: 0.0229
  [Time] 21.63s | SPS: 378
--------------------------------------------------
Iter 540/2441 | Steps: 4.42M/20.00M
  [Perf] Avg Rew: 358.92
  [Loss] Val: 37.8974 | Pol: -0.0110 | Ent: 0.8224 | KL: 0.0080
  [Time] 3.00s | SPS: 2730
--------------------------------------------------
Iter 550/2441 | Steps: 4.51M/20.00M
  [Perf] Avg Rew: 289.00
  [Loss] Val: 14.4593 | Pol: -0.0201 | Ent: 0.8370 | KL: 0.0118
  [Time] 3.96s | SPS: 2070
--------------------------------------------------
Iter 560/2441 | Steps: 4.59M/20.00M
  [Perf] Avg Rew: 441.69
  [Loss] Val: 22.8403 | Pol: -0.0092 | Ent: 0.8478 | KL: 0.0121
  [Time] 2.12s | SPS: 3864
--------------------------------------------------
Iter 570/2441 | Steps: 4.67M/20.00M
  [Perf] Avg Rew: 421.32
  [Loss] Val: 18.8439 | Pol: -0.0120 | Ent: 0.8874 | KL: 0.0143
  [Time] 3.77s | SPS: 2171
--------------------------------------------------
Iter 580/2441 | Steps: 4.75M/20.00M
  [Perf] Avg Rew: 440.58
  [Loss] Val: 19.5280 | Pol: -0.0167 | Ent: 0.8693 | KL: 0.0165
  [Time] 2.13s | SPS: 3847
--------------------------------------------------
Iter 590/2441 | Steps: 4.83M/20.00M
  [Perf] Avg Rew: 410.30
  [Loss] Val: 23.0705 | Pol: -0.0115 | Ent: 0.8696 | KL: 0.0136
  [Time] 2.27s | SPS: 3607
--------------------------------------------------
Iter 600/2441 | Steps: 4.92M/20.00M
  [Perf] Avg Rew: 296.24
  [Loss] Val: 34.0991 | Pol: -0.0114 | Ent: 0.8921 | KL: 0.0139
  [Time] 2.22s | SPS: 3685
--------------------------------------------------
Iter 610/2441 | Steps: 5.00M/20.00M
  [Perf] Avg Rew: 301.50
  [Loss] Val: 18.3073 | Pol: 0.0148 | Ent: 0.9094 | KL: 0.0726
  [Time] 3.70s | SPS: 2215
--------------------------------------------------
Iter 620/2441 | Steps: 5.08M/20.00M
  [Perf] Avg Rew: 341.46
  [Loss] Val: 34.4753 | Pol: -0.0080 | Ent: 0.9091 | KL: 0.0091
  [Time] 2.43s | SPS: 3370
--------------------------------------------------
Iter 630/2441 | Steps: 5.16M/20.00M
  [Perf] Avg Rew: 357.73
  [Loss] Val: 17.2755 | Pol: -0.0166 | Ent: 0.8974 | KL: 0.0115
  [Time] 3.71s | SPS: 2210
--------------------------------------------------
Iter 640/2441 | Steps: 5.24M/20.00M
  [Perf] Avg Rew: 333.67
  [Loss] Val: 38.8904 | Pol: -0.0106 | Ent: 0.8912 | KL: 0.0159
  [Time] 3.97s | SPS: 2061
--------------------------------------------------
Iter 650/2441 | Steps: 5.32M/20.00M
  [Perf] Avg Rew: 352.61
  [Loss] Val: 24.5160 | Pol: -0.0144 | Ent: 0.9223 | KL: 0.0120
  [Time] 3.73s | SPS: 2195
--------------------------------------------------
Iter 660/2441 | Steps: 5.41M/20.00M
  [Perf] Avg Rew: 400.04
  [Loss] Val: 9.7165 | Pol: -0.0066 | Ent: 0.9475 | KL: 0.0137
  [Time] 2.13s | SPS: 3854
--------------------------------------------------
Iter 670/2441 | Steps: 5.49M/20.00M
  [Perf] Avg Rew: 445.74
  [Loss] Val: 21.5161 | Pol: -0.0118 | Ent: 0.9673 | KL: 0.0092
  [Time] 3.55s | SPS: 2309
--------------------------------------------------
Iter 680/2441 | Steps: 5.57M/20.00M
  [Perf] Avg Rew: 437.96
  [Loss] Val: 36.8577 | Pol: -0.0148 | Ent: 0.9788 | KL: 0.0152
  [Time] 2.18s | SPS: 3753
--------------------------------------------------
Iter 690/2441 | Steps: 5.65M/20.00M
  [Perf] Avg Rew: 410.03
  [Loss] Val: 22.2318 | Pol: -0.0139 | Ent: 0.9667 | KL: 0.0082
  [Time] 3.68s | SPS: 2223
--------------------------------------------------
Iter 700/2441 | Steps: 5.73M/20.00M
  [Perf] Avg Rew: 398.29
  [Loss] Val: 18.8216 | Pol: -0.0146 | Ent: 0.9995 | KL: 0.0098
  [Time] 3.16s | SPS: 2590
--------------------------------------------------
Iter 710/2441 | Steps: 5.82M/20.00M
  [Perf] Avg Rew: 397.96
  [Loss] Val: 13.9809 | Pol: -0.0085 | Ent: 0.9700 | KL: 0.0099
  [Time] 3.29s | SPS: 2491
--------------------------------------------------
Iter 720/2441 | Steps: 5.90M/20.00M
  [Perf] Avg Rew: 428.75
  [Loss] Val: 25.9166 | Pol: -0.0146 | Ent: 0.9402 | KL: 0.0124
  [Time] 3.45s | SPS: 2377
--------------------------------------------------
Iter 730/2441 | Steps: 5.98M/20.00M
  [Perf] Avg Rew: 375.75
  [Loss] Val: 19.9858 | Pol: -0.0142 | Ent: 0.9562 | KL: 0.0172
  [Time] 3.30s | SPS: 2482
--------------------------------------------------
Iter 740/2441 | Steps: 6.06M/20.00M
  [Perf] Avg Rew: 336.23
  [Loss] Val: 27.2758 | Pol: -0.0155 | Ent: 0.9798 | KL: 0.0224
  [Time] 3.43s | SPS: 2388
--------------------------------------------------
Iter 750/2441 | Steps: 6.14M/20.00M
  [Perf] Avg Rew: 315.76
  [Loss] Val: 21.4512 | Pol: -0.0134 | Ent: 0.9457 | KL: 0.0085
  [Time] 3.33s | SPS: 2463
--------------------------------------------------
Iter 760/2441 | Steps: 6.23M/20.00M
  [Perf] Avg Rew: 298.57
  [Loss] Val: 22.9541 | Pol: -0.0168 | Ent: 0.9659 | KL: 0.0096
  [Time] 3.29s | SPS: 2488
--------------------------------------------------
Iter 770/2441 | Steps: 6.31M/20.00M
  [Perf] Avg Rew: 452.79
  [Loss] Val: 27.9671 | Pol: -0.0105 | Ent: 0.9560 | KL: 0.0083
  [Time] 3.38s | SPS: 2423
--------------------------------------------------
Iter 780/2441 | Steps: 6.39M/20.00M
  [Perf] Avg Rew: 446.49
  [Loss] Val: 31.8629 | Pol: -0.0117 | Ent: 0.9319 | KL: 0.0083
  [Time] 3.30s | SPS: 2483
--------------------------------------------------
Iter 790/2441 | Steps: 6.47M/20.00M
  [Perf] Avg Rew: 428.15
  [Loss] Val: 22.4696 | Pol: -0.0158 | Ent: 0.9267 | KL: 0.0120
  [Time] 3.32s | SPS: 2469
--------------------------------------------------
Iter 800/2441 | Steps: 6.55M/20.00M
  [Perf] Avg Rew: 419.47
  [Loss] Val: 22.5755 | Pol: -0.0078 | Ent: 0.9576 | KL: 0.0159
  [Time] 3.24s | SPS: 2528
--------------------------------------------------
Iter 810/2441 | Steps: 6.64M/20.00M
  [Perf] Avg Rew: 355.99
  [Loss] Val: 17.1757 | Pol: -0.0086 | Ent: 0.9829 | KL: 0.0268
  [Time] 3.21s | SPS: 2549
--------------------------------------------------
Iter 820/2441 | Steps: 6.72M/20.00M
  [Perf] Avg Rew: 384.91
  [Loss] Val: 32.4009 | Pol: -0.0165 | Ent: 0.9559 | KL: 0.0113
  [Time] 3.43s | SPS: 2390
--------------------------------------------------
Iter 830/2441 | Steps: 6.80M/20.00M
  [Perf] Avg Rew: 429.77
  [Loss] Val: 19.7941 | Pol: -0.0072 | Ent: 0.9106 | KL: 0.0122
  [Time] 3.35s | SPS: 2448
--------------------------------------------------
Iter 840/2441 | Steps: 6.88M/20.00M
  [Perf] Avg Rew: 423.57
  [Loss] Val: 27.5250 | Pol: -0.0085 | Ent: 0.9154 | KL: 0.0269
  [Time] 3.37s | SPS: 2433
--------------------------------------------------
Iter 850/2441 | Steps: 6.96M/20.00M
  [Perf] Avg Rew: 345.05
  [Loss] Val: 22.3027 | Pol: -0.0149 | Ent: 0.9387 | KL: 0.0146
  [Time] 3.21s | SPS: 2555
--------------------------------------------------
Iter 860/2441 | Steps: 7.05M/20.00M
  [Perf] Avg Rew: 387.53
  [Loss] Val: 24.0470 | Pol: -0.0120 | Ent: 0.9591 | KL: 0.0105
  [Time] 3.24s | SPS: 2530
--------------------------------------------------
Iter 870/2441 | Steps: 7.13M/20.00M
  [Perf] Avg Rew: 379.22
  [Loss] Val: 21.8226 | Pol: -0.0115 | Ent: 0.9541 | KL: 0.0117
  [Time] 3.26s | SPS: 2509
--------------------------------------------------
Iter 880/2441 | Steps: 7.21M/20.00M
  [Perf] Avg Rew: 383.63
  [Loss] Val: 15.0968 | Pol: -0.0005 | Ent: 0.9319 | KL: 0.0217
  [Time] 3.19s | SPS: 2565
--------------------------------------------------
Iter 890/2441 | Steps: 7.29M/20.00M
  [Perf] Avg Rew: 424.58
  [Loss] Val: 19.2837 | Pol: -0.0080 | Ent: 0.9233 | KL: 0.0091
  [Time] 3.20s | SPS: 2557
--------------------------------------------------
Iter 900/2441 | Steps: 7.37M/20.00M
  [Perf] Avg Rew: 472.37
  [Loss] Val: 15.4529 | Pol: -0.0173 | Ent: 0.9304 | KL: 0.0131
  [Time] 3.12s | SPS: 2622
--------------------------------------------------
Iter 910/2441 | Steps: 7.45M/20.00M
  [Perf] Avg Rew: 485.04
  [Loss] Val: 22.7042 | Pol: -0.0126 | Ent: 0.9101 | KL: 0.0103
  [Time] 3.31s | SPS: 2471
--------------------------------------------------
Iter 920/2441 | Steps: 7.54M/20.00M
  [Perf] Avg Rew: 414.67
  [Loss] Val: 22.9543 | Pol: -0.0201 | Ent: 0.8818 | KL: 0.0156
  [Time] 3.15s | SPS: 2598
--------------------------------------------------
Iter 930/2441 | Steps: 7.62M/20.00M
  [Perf] Avg Rew: 331.44
  [Loss] Val: 19.9654 | Pol: -0.0109 | Ent: 0.9152 | KL: 0.0076
  [Time] 3.34s | SPS: 2450
--------------------------------------------------
Iter 940/2441 | Steps: 7.70M/20.00M
  [Perf] Avg Rew: 361.20
  [Loss] Val: 23.4267 | Pol: -0.0121 | Ent: 0.9130 | KL: 0.0120
  [Time] 3.31s | SPS: 2474
--------------------------------------------------
Iter 950/2441 | Steps: 7.78M/20.00M
  [Perf] Avg Rew: 391.56
  [Loss] Val: 14.5767 | Pol: -0.0111 | Ent: 0.8961 | KL: 0.0124
  [Time] 3.15s | SPS: 2597
--------------------------------------------------
Iter 960/2441 | Steps: 7.86M/20.00M
  [Perf] Avg Rew: 360.00
  [Loss] Val: 14.3457 | Pol: -0.0136 | Ent: 0.8828 | KL: 0.0127
  [Time] 3.20s | SPS: 2561
--------------------------------------------------
Iter 970/2441 | Steps: 7.95M/20.00M
  [Perf] Avg Rew: 386.27
  [Loss] Val: 11.6056 | Pol: -0.0151 | Ent: 0.8519 | KL: 0.0179
  [Time] 3.14s | SPS: 2610
--------------------------------------------------
Iter 980/2441 | Steps: 8.03M/20.00M
  [Perf] Avg Rew: 428.47
  [Loss] Val: 14.1139 | Pol: -0.0156 | Ent: 0.8420 | KL: 0.0115
  [Time] 3.21s | SPS: 2549
--------------------------------------------------
Iter 990/2441 | Steps: 8.11M/20.00M
  [Perf] Avg Rew: 404.09
  [Loss] Val: 24.6694 | Pol: -0.0143 | Ent: 0.8142 | KL: 0.0116
  [Time] 3.24s | SPS: 2528
--------------------------------------------------
Iter 1000/2441 | Steps: 8.19M/20.00M
  [Perf] Avg Rew: 373.24
  [Loss] Val: 9.1484 | Pol: -0.0075 | Ent: 0.8258 | KL: 0.0134
  [Time] 3.80s | SPS: 2156
--------------------------------------------------
Iter 1010/2441 | Steps: 8.27M/20.00M
  [Perf] Avg Rew: 411.91
  [Loss] Val: 13.5294 | Pol: -0.0080 | Ent: 0.8200 | KL: 0.0120
  [Time] 3.22s | SPS: 2547
--------------------------------------------------
Iter 1020/2441 | Steps: 8.36M/20.00M
  [Perf] Avg Rew: 368.53
  [Loss] Val: 20.0703 | Pol: -0.0153 | Ent: 0.7939 | KL: 0.0078
  [Time] 3.19s | SPS: 2571
--------------------------------------------------
Iter 1030/2441 | Steps: 8.44M/20.00M
  [Perf] Avg Rew: 378.71
  [Loss] Val: 9.6055 | Pol: -0.0185 | Ent: 0.7767 | KL: 0.0127
  [Time] 3.08s | SPS: 2659
--------------------------------------------------
Iter 1040/2441 | Steps: 8.52M/20.00M
  [Perf] Avg Rew: 446.27
  [Loss] Val: 36.2443 | Pol: -0.0153 | Ent: 0.7577 | KL: 0.0075
  [Time] 3.21s | SPS: 2554
--------------------------------------------------
Iter 1050/2441 | Steps: 8.60M/20.00M
  [Perf] Avg Rew: 460.04
  [Loss] Val: 9.2903 | Pol: -0.0138 | Ent: 0.7526 | KL: 0.0087
  [Time] 3.11s | SPS: 2631
--------------------------------------------------
Iter 1060/2441 | Steps: 8.68M/20.00M
  [Perf] Avg Rew: 521.10
  [Loss] Val: 16.1969 | Pol: -0.0100 | Ent: 0.7320 | KL: 0.0099
  [Time] 3.18s | SPS: 2572
--------------------------------------------------
  [★] 新纪录！最佳模型已保存 (Rew: 521.10)
Iter 1070/2441 | Steps: 8.77M/20.00M
  [Perf] Avg Rew: 481.28
  [Loss] Val: 26.3126 | Pol: -0.0176 | Ent: 0.7014 | KL: 0.0096
  [Time] 3.09s | SPS: 2649
--------------------------------------------------
Iter 1080/2441 | Steps: 8.85M/20.00M
  [Perf] Avg Rew: 420.64
  [Loss] Val: 12.2517 | Pol: -0.0104 | Ent: 0.7073 | KL: 0.0107
  [Time] 3.07s | SPS: 2671
--------------------------------------------------
Iter 1090/2441 | Steps: 8.93M/20.00M
  [Perf] Avg Rew: 455.08
  [Loss] Val: 23.0135 | Pol: -0.0154 | Ent: 0.7066 | KL: 0.0116
  [Time] 3.38s | SPS: 2420
--------------------------------------------------
Iter 1100/2441 | Steps: 9.01M/20.00M
  [Perf] Avg Rew: 321.27
  [Loss] Val: 34.7168 | Pol: -0.0146 | Ent: 0.6991 | KL: 0.0077
  [Time] 3.32s | SPS: 2464
--------------------------------------------------
Iter 1110/2441 | Steps: 9.09M/20.00M
  [Perf] Avg Rew: 391.11
  [Loss] Val: 35.1363 | Pol: -0.0098 | Ent: 0.6953 | KL: 0.0153
  [Time] 3.24s | SPS: 2529
--------------------------------------------------
Iter 1120/2441 | Steps: 9.18M/20.00M
  [Perf] Avg Rew: 424.13
  [Loss] Val: 42.8737 | Pol: -0.0132 | Ent: 0.7004 | KL: 0.0080
  [Time] 3.31s | SPS: 2474
--------------------------------------------------
Iter 1130/2441 | Steps: 9.26M/20.00M
  [Perf] Avg Rew: 403.10
  [Loss] Val: 13.6796 | Pol: -0.0103 | Ent: 0.6967 | KL: 0.0131
  [Time] 3.21s | SPS: 2549
--------------------------------------------------
Iter 1140/2441 | Steps: 9.34M/20.00M
  [Perf] Avg Rew: 375.40
  [Loss] Val: 17.2960 | Pol: -0.0140 | Ent: 0.6944 | KL: 0.0117
  [Time] 3.19s | SPS: 2569
--------------------------------------------------
Iter 1150/2441 | Steps: 9.42M/20.00M
  [Perf] Avg Rew: 385.99
  [Loss] Val: 36.0999 | Pol: -0.0140 | Ent: 0.6798 | KL: 0.0096
  [Time] 3.31s | SPS: 2475
--------------------------------------------------
Iter 1160/2441 | Steps: 9.50M/20.00M
  [Perf] Avg Rew: 386.48
  [Loss] Val: 23.0879 | Pol: -0.0148 | Ent: 0.6762 | KL: 0.0100
  [Time] 3.34s | SPS: 2455
--------------------------------------------------
Iter 1170/2441 | Steps: 9.58M/20.00M
  [Perf] Avg Rew: 395.78
  [Loss] Val: 12.3838 | Pol: -0.0151 | Ent: 0.6829 | KL: 0.0125
  [Time] 3.18s | SPS: 2573
--------------------------------------------------
Iter 1180/2441 | Steps: 9.67M/20.00M
  [Perf] Avg Rew: 430.15
  [Loss] Val: 25.7486 | Pol: -0.0178 | Ent: 0.6720 | KL: 0.0125
  [Time] 3.18s | SPS: 2577
--------------------------------------------------
Iter 1190/2441 | Steps: 9.75M/20.00M
  [Perf] Avg Rew: 439.23
  [Loss] Val: 27.0303 | Pol: -0.0123 | Ent: 0.6660 | KL: 0.0092
  [Time] 3.17s | SPS: 2582
--------------------------------------------------
Iter 1200/2441 | Steps: 9.83M/20.00M
  [Perf] Avg Rew: 405.64
  [Loss] Val: 8.2630 | Pol: -0.0120 | Ent: 0.6826 | KL: 0.0115
  [Time] 3.11s | SPS: 2634
--------------------------------------------------
Iter 1210/2441 | Steps: 9.91M/20.00M
  [Perf] Avg Rew: 406.04
  [Loss] Val: 17.0200 | Pol: -0.0130 | Ent: 0.6697 | KL: 0.0144
  [Time] 3.23s | SPS: 2535
--------------------------------------------------
Iter 1220/2441 | Steps: 9.99M/20.00M
  [Perf] Avg Rew: 386.10
  [Loss] Val: 26.3602 | Pol: -0.0183 | Ent: 0.6634 | KL: 0.0127
  [Time] 3.36s | SPS: 2438
--------------------------------------------------
Iter 1230/2441 | Steps: 10.08M/20.00M
  [Perf] Avg Rew: 441.31
  [Loss] Val: 30.9151 | Pol: -0.0087 | Ent: 0.6697 | KL: 0.0202
  [Time] 3.36s | SPS: 2438
--------------------------------------------------
Iter 1240/2441 | Steps: 10.16M/20.00M
  [Perf] Avg Rew: 462.81
  [Loss] Val: 29.9933 | Pol: -0.0089 | Ent: 0.6739 | KL: 0.0139
  [Time] 3.99s | SPS: 2052
--------------------------------------------------
Iter 1250/2441 | Steps: 10.24M/20.00M
  [Perf] Avg Rew: 343.76
  [Loss] Val: 16.6866 | Pol: -0.0159 | Ent: 0.6826 | KL: 0.0101
  [Time] 4.08s | SPS: 2006
--------------------------------------------------


[警报] 用户手动停止训练 (Ctrl+C)！
  [安全] 模型已紧急保存到: /data/repos/lsy_drone_racing/lsy_drone_racing/rl_training/checkpoints/ppo_racing.ckpt
正在关闭环境...
