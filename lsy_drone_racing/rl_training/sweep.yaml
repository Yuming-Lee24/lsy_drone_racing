# WandB Sweep 配置文件
# 使用方法:
#   wandb sweep sweep.yaml
#   wandb agent <sweep_id>

program: ppo_racing.py
method: bayes  # 贝叶斯优化
metric:
  name: train/episode_reward
  goal: maximize

parameters:
  # PPO 超参数
  learning_rate:
    distribution: log_uniform_values
    min: 1e-4
    max: 3e-3
  
  gamma:
    values: [0.95, 0.97, 0.99]
  
  gae_lambda:
    values: [0.9, 0.95, 0.97]
  
  clip_coef:
    distribution: uniform
    min: 0.1
    max: 0.3
  
  ent_coef:
    distribution: log_uniform_values
    min: 0.001
    max: 0.05
  
  vf_coef:
    distribution: uniform
    min: 0.3
    max: 0.7
  
  num_steps:
    values: [16, 32, 64]
  
  # 网络结构
  hidden_dim:
    values: [128, 256, 512]
  
  # 奖励系数
  # coef_progress:
  #   distribution: uniform
  #   min: 0.5
  #   max: 2.0
  
  # coef_gate:
  #   values: [5.0, 10.0, 15.0]
  
  # coef_align:
  #   distribution: uniform
  #   min: 0.1
  #   max: 1.0
  
  # coef_collision:
  #   values: [3.0, 5.0, 10.0]
  
  # coef_smooth:
  #   distribution: log_uniform_values
  #   min: 0.01
  #   max: 0.5
  
  # coef_spin:
  #   distribution: log_uniform_values
  #   min: 0.005
  #   max: 0.1
  # coef_angle:
  #   distribution: uniform
  #   min: 0.01
  #   max: 0.1

# 固定参数
command:
  - ${env}
  - python
  - ${program}
  - --wandb_enabled=True
  - --train=True
  - --eval=0
  - ${args}